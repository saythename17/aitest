<!-- @format -->

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>첫인상 테스트</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />

    <meta
      property="(AI 테스트)내 첫인상으로 배정 받는 호그와트 기숙사!"
      content="나는 슬리데린상? 그리핀도르상? 당신의 첫인상으로 해리포터 기숙사를 배정받을 수 있는 초대장이 도착했어요."
      content="https://www.arealme.com/cover-images/harry-potter-house-sort.png"
    />
  </head>
  <body>
    <!-- 	navbar	 -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary nav-distance">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">첫인상 테스트</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" aria-disabled="true">Disabled</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- 	navbar	 -->

    <!-- 	title	 -->

    <section class="section">
      <h2 class="title">(AI)첫인상으로 받아보는 호그와트 기숙사 배정</h2>
      <h4 class="subtitle">
        나는 슬리데린상? 그리핀도르상?<br />인공지능을 통해 첫인상으로 알아
        보자!
      </h4>
    </section>

    <section class="container munto d-flex flex-row-reverse mt-5">
      <div class="link-cover">
        <a
          href="https://wild-gauge-6fa.notion.site/dd12487e32e240de88b0d0d3a6da88b2?pvs=4"
          class="munto-link"
          >여친에게 칭찬받는 데이트 코스의 비결?</a
        >
        <img src="image/ic_munto.png" alt="" class="munto-icon" />
      </div>
    </section>
    <!-- 	title	 -->

    <div id="image-section" class="container">
      <div class="container">
        <div class="preview">
          <text class="guide-upload-text"
            >아래 버튼을 눌러<br />사진을 업로드 하세요!</text
          >
        </div>
        <button id="triggerUpload" class="btn shadowButton">
          Upload Image
        </button>
        <input type="file" id="filePicker" />

        <div id="loader-container" class="d-flex justify-content-center mt-5">
          <div id="loading-progress"></div>
        </div>

        <p class="result-message mt-5"></p>

        <div id="label-container">
          <!-- <span id="dormitory"></span>
					<div
						class="progress"
						role="progressbar"
						aria-label="Success example"
						aria-valuenow="25"
						aria-valuemin="0"
						aria-valuemax="100"
					>
						<div id="dormitory-progress-bar" class="progress-bar bg-success"></div>
					</div> -->
        </div>
      </div>

      <!-- 	sns share	 -->
      <div
        id="sns-share"
        class="container mt-5 mb-5 d-flex justify-content-center"
      >
        <a id="kakaotalk-sharing-btn" href="javascript:;">
          <img
            class="share-btn"
            src="https://developers.kakao.com/assets/img/about/logos/kakaotalksharing/kakaotalk_sharing_btn_medium.png"
            alt="카카오톡 공유 보내기 버튼"
          />
        </a>

        <a id="facebook-sharing-btn" href="javascript:shareFacebook();">
          <img
            class="share-btn"
            src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/2048px-2021_Facebook_icon.svg.png"
            alt="페이스북 공유 보내기 버튼"
          />
        </a>

        <a id="twitter-share-button" href="javascript:shareTwitter();">
          <img
            class="share-btn"
            src="https://cdn-icons-png.flaticon.com/512/3670/3670151.png"
            alt="트위터 공유 보내기 버튼"
          />
        </a>
      </div>
      <!-- 	sns share	 -->

      <button id="retry" class="btn shadowButton">Retry</button>

      <!-- <button class="btn shadowButton" onclick="init()">Start</button> -->
    </div>
    <br /><br /><br /><br /><br />

    <!--❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️-->

    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <div id="disqus_thread" class="p-3"></div>
    <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
      /*
	var disqus_config = function () {
	this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
	this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
	};
	*/
      ;(function () {
        // DON'T EDIT BELOW THIS LINE
        var d = document,
          s = d.createElement('script')
        s.src = 'https://xiotest.disqus.com/embed.js'
        s.setAttribute('data-timestamp', +new Date())
        ;(d.head || d.body).appendChild(s)
      })()
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
      // More API functions here:
      // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

      // the link to your model provided by Teachable Machine export panel
      const URL = 'https://teachablemachine.withgoogle.com/models/O4mAHf4Mp/'

      let model, webcam, labelContainer, maxPredictions

      // Load the image model and setup the image
      async function init() {
        const modelURL = URL + 'model.json'
        const metadataURL = URL + 'metadata.json'

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // or files from your local hard drive
        // Note: the pose library adds "tmImage" object to your window (window.tmImage)
        model = await tmImage.load(modelURL, metadataURL)
        maxPredictions = model.getTotalClasses()

        const labelContainer = document.getElementById('label-container')
        for (let i = 0; i < maxPredictions; i++) {
          // and class labels
          labelContainer.appendChild(document.createElement('div'))
        }
      }

      // run the webcam image through the image model
      async function predict() {
        document.getElementById('loading-progress').style.display = 'none'
        document.getElementById('image-section').style.height = '65em'
        document.getElementById('sns-share').style.visibility = 'visible'
        const retryButton = document.getElementById('retry')
        retryButton.style.visibility = 'visible'
        retryButton.onclick = () => location.reload(true)

        var imageElement = document.getElementById('img-preview')
        // predict can take in an image, video or canvas html element
        const prediction = await model.predict(imageElement, false)
        prediction.sort((a, b) => b.probability - a.probability)

        var resultMessage = ''
        switch (prediction[0].className) {
          case '그리핀도르':
            resultMessage =
              '용감하고 대담한 자를 위한 기숙사<br /><b>"그 이름에 걸맞은 용기를 보여주는 아이들은 누구나 다 가르치도록 하세!"</ b>'
            break
          case '후플푸프':
            resultMessage =
              '성실하고 진실된 자들을 위한 기숙사<br /><b>"나는 그 아이들을 똑같이 가르칠 걸세!"</ b>'
            break
          case '레번클로':
            resultMessage =
              '현명하고 사려 깊은 자들을 위한 기숙사<br /><b>"가장 똑똑한 아이들만 가르치도록 하세!"</ b>'
            break
          case '슬리데린':
            resultMessage =
              '재간꾼들을 위한 기숙사<br /><b>"가장 순수한 혈통을 지닌 아이들만 가르치도록 하세!"</ b>'
            break
          default:
            resultMessage = '안타깝게도 자네는 머글일세..'
            break
        }
        $('.result-message').html(resultMessage)

        for (let i = 0; i < prediction.length; i++) {
          console.log(prediction[i])
          const predictedPercent = prediction[i].probability.toFixed(2) * 100
          const predictedPercentToString = `${prediction[i].className}: ${predictedPercent}%`
          const progressLabel =
            prediction[i].className == '그리핀도르'
              ? 'Danger example'
              : prediction[i].className == '후플푸프'
              ? 'Success example'
              : prediction[i].className == '레번클로'
              ? 'Warning example'
              : 'Info example'
          const progressBarColorClass =
            prediction[i].className == '그리핀도르'
              ? 'progress-bar bg-danger'
              : prediction[i].className == '후플푸프'
              ? 'progress-bar bg-warning'
              : prediction[i].className == '레번클로'
              ? 'progress-bar bg-info'
              : 'progress-bar bg-success'
          console.log(progressLabel)
          console.log(progressLabel.type)

          const labelContainer = document.getElementById('label-container')
          labelContainer.style.display = 'block'

          const temp = document.createElement('div')
          temp.id = 'label-bar-container'
          temp.className = 'd-flex justify-content-between'

          temp.innerHTML = `
					<span class="dormitory" style="width: 80px">${prediction[i].className}</span>
					<div
						class="progress loading-progress"
						role="progressbar"
						aria-label=${progressLabel}
						aria-valuenow="25"
						aria-valuemin="0"
						aria-valuemax="100"
					>
						<div id="dormitory-progress-bar" class="${progressBarColorClass}" style="width: ${predictedPercent}%;">${predictedPercent}%</div>
					</div>`

          labelContainer.append(temp)

          // document.getElementById('dormitory').innerHTML = prediction[0].className;
          // const progressBar = document.getElementById('dormitory-progress-bar');
          // progressBar.innerHTML = `${predictedPercent}%`
          // progressBar.style.width = `${predictedPercent}%`;
        }
      }
    </script>
    <script>
      var triggerUpload = document.getElementById('triggerUpload'),
        upInput = document.getElementById('filePicker'),
        preview = document.querySelector('.preview')

      //force triggering the file upload here...
      triggerUpload.onclick = function () {
        upInput.click()
      }

      upInput.onchange = function (e) {
        var uploaded = this.value,
          ext = uploaded.substring(uploaded.lastIndexOf('.') + 1),
          ext = ext.toLowerCase(),
          fileName = uploaded.substring(uploaded.lastIndexOf('\\') + 1),
          accepted = ['jpg', 'png', 'gif', 'jpeg']

        /*
					::Add in blank img tag and spinner
					::Use FileReader to read the img data
					::Set the image source to the FileReader data
				  */
        function showPreview() {
          // document.getElementById('image-section').style.height = '37em';

          preview.innerHTML = "<div class='loadingLogo'></div>"
          preview.innerHTML += '<img id="img-preview" />'
          var reader = new FileReader()
          reader.onload = function () {
            var img = document.getElementById('img-preview')
            img.src = reader.result
          }
          reader.readAsDataURL(e.target.files[0])
          preview.removeChild(document.querySelector('.loadingLogo'))
          document.getElementById('loading-progress').style.display = 'block'
          // document.querySelector('.fileName').innerHTML = fileName + '<b> Uploaded!</b>';
        }

        //only do if supported image file
        if (new RegExp(accepted.join('|')).test(ext)) {
          showPreview()
        } else {
          preview.innerHTML = ''
          document.querySelector('.fileName').innerHTML =
            'Hey! Upload an image file, not a <b>.' + ext + '</b> file!'
        }

        init().then(() => predict())
        triggerUpload.style.display = 'none'
      }
    </script>
    <script
      src="https://t1.kakaocdn.net/kakao_js_sdk/2.4.0/kakao.min.js"
      integrity="sha384-mXVrIX2T/Kszp6Z0aEWaA8Nm7J6/ZeWXbL8UpGRjKwWe56Srd/iyNmWMBhcItAjH"
      crossorigin="anonymous"
    ></script>
    <script>
      Kakao.init('47539da45396a0779c5df7855b984186') // 사용하려는 앱의 JavaScript 키 입력
    </script>

    <script>
      Kakao.Share.createDefaultButton({
        container: '#kakaotalk-sharing-btn',
        objectType: 'feed',
        content: {
          title: '(AI 테스트)내 첫인상으로 배정 받는 호그와트 기숙사!',
          description:
            '나는 슬리데린상? 그리핀도르상? 학습된 AI를 통해 첫인상으로 호그와트 기숙사 배정을 받아보자!',
          imageUrl:
            'https://www.arealme.com/cover-images/harry-potter-house-sort.png',
          link: {
            // [내 애플리케이션] > [플랫폼] 에서 등록한 사이트 도메인과 일치해야 함
            mobileWebUrl: 'https://mbti-face-rgnto.run.goorm.site',
            webUrl: 'https://mbti-face-rgnto.run.goorm.site',
          },
        },
        social: {
          likeCount: 286,
          commentCount: 45,
          sharedCount: 845,
        },
        buttons: [
          {
            title: '웹으로 보기',
            link: {
              mobileWebUrl: 'https://developers.kakao.com',
              webUrl: 'https://developers.kakao.com',
            },
          },
          {
            title: '앱으로 보기',
            link: {
              mobileWebUrl: 'https://developers.kakao.com',
              webUrl: 'https://developers.kakao.com',
            },
          },
        ],
      })
    </script>
    <script>
      const sendText = '(AI 테스트)내 첫인상으로 배정 받는 호그와트 기숙사!' // 공유할 텍스트
      const sendUrl = 'https://xio-ai-test.netlify.app' // 공유할 URL

      const facebookBtn = document.getElementById('facebook-sharing-btn')
      facebookBtn.addEventListener(
        'click',
        () => {
          window.open(
            `http://www.facebook.com/sharer/sharer.php?u=${sendText}&url=${sendUrl}`
          )
        },
        false
      )

      const twitterBtn = document.getElementById('twitter-share-button')
      twitterBtn.addEventListener(
        'click',
        () => {
          window.open(
            `https://twitter.com/intent/tweet?text=${sendText}&url=${sendUrl}`
          )
        },
        false
      )
    </script>
  </body>
</html>
